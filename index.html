<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IGCSE Study Manager Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <style>
        :root {
            /* Material 3 Color Scheme */
            --primary: #6750A4;
            --on-primary: #FFFFFF;
            --primary-container: #EADDFF;
            --on-primary-container: #21005D;
            --secondary: #625B71;
            --on-secondary: #FFFFFF;
            --secondary-container: #E8DEF8;
            --on-secondary-container: #1D192B;
            --tertiary: #7D5260;
            --on-tertiary: #FFFFFF;
            --tertiary-container: #FFD8E4;
            --on-tertiary-container: #31111D;
            --surface: #FFFBFE;
            --on-surface: #1C1B1F;
            --surface-variant: #E7E0EC;
            --on-surface-variant: #49454F;
            --outline: #79747E;
            --outline-variant: #CAC4D0;
            --shadow: #000000;
            --scrim: #000000;
            
            /* Component Colors */
            --background: #FFFBFE;
            --surface-1: #F9F9FD;
            --surface-2: #F2F0F7;
            --surface-3: #E6E0EC;
            --card-bg: #FFFFFF;
            --card-shadow: rgba(0, 0, 0, 0.08);
            --text-primary: #1C1B1F;
            --text-secondary: #63606B;
            --text-tertiary: #79747E;
            --divider: #E6E0EC;
            --success: #4CAF50;
            --warning: #FF9800;
            --error: #F44336;
            --accent: #6750A4;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: var(--background);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            transition: background 0.3s ease;
        }

        .sidebar {
            width: 280px;
            background: var(--surface-1);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px var(--card-shadow);
            z-index: 100;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-right: 1px solid var(--divider);
            height: 100vh;
            position: fixed;
        }

        .sidebar.collapsed {
            width: 60px;
        }

        .sidebar-header {
            padding: 24px 20px 16px;
            background: var(--primary);
            color: var(--on-primary);
            position: relative;
            border-bottom: 1px solid var(--primary-container);
        }

        .sidebar-toggle {
            position: absolute;
            top: 20px;
            right: 16px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: var(--on-primary);
            font-size: 1.2rem;
            cursor: pointer;
            transition: transform 0.3s ease;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sidebar-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .sidebar h1 {
            font-size: 1.4rem;
            font-weight: 500;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .sidebar p {
            font-size: 0.9rem;
            opacity: 0.9;
            font-weight: 300;
        }

        .nav-menu {
            padding: 16px 0;
        }

        .nav-item {
            margin-bottom: 4px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            border-radius: 0 28px 28px 0;
            margin: 0 8px;
        }

        .nav-link:hover, .nav-link.active {
            background: var(--primary-container);
            color: var(--on-primary-container);
        }

        .nav-icon {
            margin-right: 16px;
            font-size: 1.4rem;
            width: 24px;
            text-align: center;
        }

        .nav-text {
            transition: opacity 0.3s ease;
            font-weight: 400;
        }

        .collapsed .nav-text {
            opacity: 0;
        }

        .subject-item {
            margin-left: 10px;
        }

        .subject-link {
            padding: 10px 30px;
            font-size: 0.95rem;
            font-weight: 500;
        }

        .month-items {
            margin-left: 20px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .month-items.expanded {
            max-height: 300px;
        }

        .month-link {
            padding: 8px 40px;
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-weight: 400;
        }

        .month-link:hover {
            color: var(--primary);
            background: rgba(103, 80, 164, 0.08);
        }

        .main-content {
            flex: 1;
            overflow-x: hidden;
            overflow-y: auto;
            padding-top: 80px;
            margin-left: 280px;
            transition: margin-left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .sidebar.collapsed ~ .main-content {
            margin-left: 60px;
        }

        .header {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            padding: 20px 30px;
            box-shadow: 0 2px 10px var(--card-shadow);
            margin-bottom: 30px;
            border-bottom: 1px solid var(--divider);
            position: fixed;
            top: 0;
            left: 280px;
            right: 0;
            z-index: 90;
            transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .sidebar.collapsed ~ .main-content .header {
            left: 60px;
        }

        .content-area {
            padding: 0 30px 30px;
        }

        .page {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            margin-bottom: 30px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 2px 10px var(--card-shadow);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid var(--divider);
            backdrop-filter: blur(10px);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px var(--card-shadow);
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .card-icon {
            font-size: 1.5rem;
        }

        .progress-circle {
            position: relative;
            width: 100px;
            height: 100px;
            margin: 0 auto 20px;
        }

        .progress-ring {
            transform: rotate(-90deg);
        }

        .progress-ring-circle {
            stroke: var(--surface-variant);
            stroke-width: 8;
            fill: transparent;
            r: 40;
            cx: 50;
            cy: 50;
        }

        .progress-ring-progress {
            stroke: var(--primary);
            stroke-width: 8;
            fill: transparent;
            r: 40;
            cx: 50;
            cy: 50;
            stroke-dasharray: 251.2;
            stroke-dashoffset: 251.2;
            transition: stroke-dashoffset 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: 700;
            color: var(--primary);
            font-size: 1.2rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-top: 16px;
        }

        .stat-item {
            text-align: center;
            padding: 12px;
            background: var(--surface-2);
            border-radius: 12px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .stat-item:hover {
            background: var(--primary-container);
            transform: translateY(-3px);
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        .upcoming-list {
            list-style: none;
        }

        .upcoming-item {
            display: flex;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid var(--divider);
        }

        .upcoming-item:last-child {
            border-bottom: none;
        }

        .upcoming-date {
            background: var(--primary);
            color: var(--on-primary);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            margin-right: 16px;
            min-width: 70px;
            text-align: center;
        }

        .upcoming-content {
            flex: 1;
        }

        .upcoming-title {
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .upcoming-subject {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .topic-list {
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: 0 2px 10px var(--card-shadow);
            border: 1px solid var(--divider);
            margin-bottom: 30px;
        }

        .topic-header {
            padding: 24px 24px;
            border-bottom: 1px solid var(--divider);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .month-section {
            border-bottom: 1px solid var(--divider);
        }

        .month-header {
            padding: 20px 24px;
            background: var(--surface-2);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 12px;
            margin: 16px 16px 0;
        }

        .month-header:hover {
            background: var(--primary-container);
        }

        .month-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .month-progress {
            font-size: 0.9rem;
            color: var(--primary);
            font-weight: 500;
        }

        .expand-icon {
            font-size: 1.4rem;
            color: var(--text-secondary);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .month-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .month-content.expanded {
            max-height: 1000px;
        }

        .month-header.expanded .expand-icon {
            transform: rotate(180deg);
        }

        .topic-group {
            padding: 0 24px;
        }

        .group-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary);
            margin: 20px 0 15px;
            padding-left: 12px;
            border-left: 4px solid var(--primary);
        }

        .topic-item {
            display: flex;
            align-items: center;
            padding: 16px 16px;
            margin-bottom: 12px;
            background: var(--surface-1);
            border-radius: 12px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            border: 1px solid var(--divider);
        }

        .topic-item:hover {
            background: var(--primary-container);
            transform: translateX(5px);
        }

        .status-indicator {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            margin-right: 16px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            flex-shrink: 0;
            border: 2px solid transparent;
        }

        .status-not-started {
            background: var(--surface-variant);
            border-color: var(--outline-variant);
        }

        .status-in-progress {
            background: var(--warning);
            border-color: var(--warning);
        }

        .status-mastered {
            background: var(--success);
            border-color: var(--success);
        }

        .status-indicator::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .status-mastered::after {
            content: '✓';
            color: white;
            font-weight: bold;
            font-size: 14px;
        }

        .topic-text {
            font-size: 1rem;
            color: var(--text-primary);
            flex-grow: 1;
            line-height: 1.4;
        }

        .topic-actions {
            display: flex;
            gap: 12px;
            opacity: 0;
            transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .topic-item:hover .topic-actions {
            opacity: 1;
        }

        .action-btn {
            background: none;
            border: none;
            padding: 6px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1.2rem;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .action-btn:hover {
            background: var(--surface-2);
            color: var(--primary);
        }

        .note-btn {
            color: var(--primary);
        }

        .delete-btn {
            color: var(--error);
        }

        .task-manager {
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: 0 2px 10px var(--card-shadow);
            margin-bottom: 30px;
            border: 1px solid var(--divider);
        }

        .task-header {
            padding: 24px 24px;
            border-bottom: 1px solid var(--divider);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .add-task-btn {
            background: var(--primary);
            color: var(--on-primary);
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 6px var(--card-shadow);
        }

        .add-task-btn:hover {
            background: var(--on-primary-container);
            color: var(--primary-container);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px var(--card-shadow);
        }

        .task-form {
            padding: 24px 24px;
            border-bottom: 1px solid var(--divider);
            display: none;
        }

        .task-form.active {
            display: block;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-label {
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .form-input, .form-select, .form-textarea {
            padding: 12px 16px;
            border: 1px solid var(--divider);
            border-radius: 12px;
            font-size: 1rem;
            background: var(--surface-1);
            color: var(--text-primary);
            transition: border-color 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(103, 80, 164, 0.2);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 16px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: var(--on-primary);
        }

        .btn-secondary {
            background: var(--surface-2);
            color: var(--text-secondary);
            border: 1px solid var(--divider);
        }

        .btn:hover {
            transform: translateY(-1px);
        }

        .task-list {
            padding: 24px 24px;
        }

        .task-item {
            display: flex;
            align-items: center;
            padding: 16px;
            margin-bottom: 12px;
            background: var(--surface-1);
            border-radius: 12px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid var(--divider);
        }

        .task-item:hover {
            background: var(--primary-container);
        }

        .task-checkbox {
            margin-right: 16px;
            width: 20px;
            height: 20px;
            accent-color: var(--primary);
        }

        .task-content {
            flex: 1;
        }

        .task-title {
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .task-meta {
            font-size: 0.85rem;
            color: var(--text-secondary);
            display: flex;
            gap: 16px;
        }

        .priority-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .priority-high {
            background: rgba(244, 67, 54, 0.15);
            color: var(--error);
        }

        .priority-medium {
            background: rgba(255, 152, 0, 0.15);
            color: var(--warning);
        }

        .priority-low {
            background: rgba(76, 175, 80, 0.15);
            color: var(--success);
        }

        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 24px;
        }

        .chart-container {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 2px 10px var(--card-shadow);
            border: 1px solid var(--divider);
        }

        .chart-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 20px;
            text-align: center;
        }

        .notes-container {
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: 0 2px 10px var(--card-shadow);
            border: 1px solid var(--divider);
        }

        .notes-header {
            padding: 24px 24px;
            border-bottom: 1px solid var(--divider);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .note-editor {
            padding: 24px 24px;
            display: none;
        }

        .note-editor.active {
            display: block;
        }

        .notes-list {
            padding: 24px 24px;
        }

        .note-item {
            padding: 16px;
            margin-bottom: 12px;
            background: var(--surface-1);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid var(--divider);
            position: relative;
        }

        .note-item:hover {
            background: var(--primary-container);
        }

        .note-title {
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .note-preview {
            font-size: 0.95rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .note-actions {
            position: absolute;
            top: 16px;
            right: 16px;
            display: flex;
            gap: 8px;
            opacity: 0;
            transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .note-item:hover .note-actions {
            opacity: 1;
        }

        .mobile-menu-toggle {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 200;
            background: var(--primary);
            color: var(--on-primary);
            border: none;
            padding: 12px;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 2px 6px var(--card-shadow);
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            transform: scale(0.9);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid var(--divider);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .modal.active .modal-content {
            transform: scale(1);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
            transition: color 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            background: var(--surface-2);
            color: var(--primary);
        }

        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, var(--primary), var(--on-primary));
            color: white;
            padding: 20px 40px;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: 500;
            z-index: 1000;
            opacity: 0;
            animation: celebrate 2s ease;
            pointer-events: none;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        @keyframes celebrate {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            20% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
            80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
        }

        /* Responsive adjustments */
        @media (max-width: 900px) {
            .sidebar {
                position: fixed;
                left: -280px;
                top: 0;
                height: 100vh;
                z-index: 150;
                transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            }
            
            .sidebar.mobile-open {
                left: 0;
            }
            
            .mobile-menu-toggle {
                display: block;
            }
            
            .main-content {
                margin-left: 0;
                padding-top: 60px;
            }
            
            .header {
                left: 0;
                padding: 16px 20px;
            }
            
            .form-row {
                grid-template-columns: 1fr;
                gap: 16px;
            }
            
            .dashboard-grid,
            .analytics-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Material 3 components */
        .elevation-1 {
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .elevation-2 {
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .elevation-3 {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1), 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .elevation-4 {
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1), 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .elevation-5 {
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.1), 0 6px 12px rgba(0, 0, 0, 0.1);
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--surface-1);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-container);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }
    </style>
</head>
<body>
    <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">☰</button>
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h1><i class="material-icons">school</i> IGCSE Study Pro</h1>
            <p>Progress Tracker</p>
            <button class="sidebar-toggle" onclick="toggleSidebar()">◀</button>
        </div>
        <nav class="nav-menu">
            <div class="nav-item">
                <a class="nav-link active" onclick="showPage('dashboard')">
                    <span class="nav-icon material-icons">dashboard</span>
                    <span class="nav-text">Dashboard</span>
                </a>
            </div>
            <div class="nav-item">
                <a class="nav-link" onclick="showPage('tasks')">
                    <span class="nav-icon material-icons">task</span>
                    <span class="nav-text">Tasks</span>
                </a>
            </div>
            <div class="nav-item">
                <a class="nav-link" onclick="showPage('analytics')">
                    <span class="nav-icon material-icons">bar_chart</span>
                    <span class="nav-text">Analytics</span>
                </a>
            </div>
            <div class="nav-item">
                <a class="nav-link" onclick="showPage('notes')">
                    <span class="nav-icon material-icons">note</span>
                    <span class="nav-text">Notes</span>
                </a>
            </div>
            <div class="nav-item subject-item">
                <a class="nav-link subject-link" onclick="toggleSubject('math')">
                    <span class="nav-icon material-icons">calculate</span>
                    <span class="nav-text">Mathematics</span>
                </a>
                <div class="month-items" id="math-months">
                    <a class="nav-link month-link" onclick="showSubjectPage('math', 'september')">September</a>
                    <a class="nav-link month-link" onclick="showSubjectPage('math', 'october')">October</a>
                    <a class="nav-link month-link" onclick="showSubjectPage('math', 'november')">November</a>
                    <a class="nav-link month-link" onclick="showSubjectPage('math', 'december')">December</a>
                </div>
            </div>
            <div class="nav-item subject-item">
                <a class="nav-link subject-link" onclick="toggleSubject('english')">
                    <span class="nav-icon material-icons">book</span>
                    <span class="nav-text">English</span>
                </a>
                <div class="month-items" id="english-months">
                    <a class="nav-link month-link" onclick="showSubjectPage('english', 'september')">September</a>
                    <a class="nav-link month-link" onclick="showSubjectPage('english', 'october')">October</a>
                    <a class="nav-link month-link" onclick="showSubjectPage('english', 'november')">November</a>
                    <a class="nav-link month-link" onclick="showSubjectPage('english', 'december')">December</a>
                </div>
            </div>
        </nav>
    </aside>
    <main class="main-content">
        <header class="header">
            <h1 id="page-title">Dashboard Overview</h1>
        </header>
        <div class="content-area">
            <!-- Dashboard Page -->
            <div id="dashboard" class="page active">
                <div class="dashboard-grid">
                    <div class="card elevation-2">
                        <h3 class="card-title">
                            <span class="card-icon material-icons">calculate</span>
                            Mathematics Progress
                        </h3>
                        <div class="progress-circle">
                            <svg class="progress-ring" width="100" height="100">
                                <circle class="progress-ring-circle" />
                                <circle class="progress-ring-progress" id="math-ring" />
                            </svg>
                            <div class="progress-text" id="math-progress-text">0%</div>
                        </div>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <div class="stat-number" id="math-mastered">0</div>
                                <div class="stat-label">Mastered</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="math-progress">0</div>
                                <div class="stat-label">In Progress</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="math-not-started">0</div>
                                <div class="stat-label">Not Started</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="math-total">0</div>
                                <div class="stat-label">Total Topics</div>
                            </div>
                        </div>
                    </div>
                    <div class="card elevation-2">
                        <h3 class="card-title">
                            <span class="card-icon material-icons">book</span>
                            English Progress
                        </h3>
                        <div class="progress-circle">
                            <svg class="progress-ring" width="100" height="100">
                                <circle class="progress-ring-circle" />
                                <circle class="progress-ring-progress" id="english-ring" />
                            </svg>
                            <div class="progress-text" id="english-progress-text">0%</div>
                        </div>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <div class="stat-number" id="english-mastered">0</div>
                                <div class="stat-label">Mastered</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="english-progress">0</div>
                                <div class="stat-label">In Progress</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="english-not-started">0</div>
                                <div class="stat-label">Not Started</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="english-total">0</div>
                                <div class="stat-label">Total Topics</div>
                            </div>
                        </div>
                    </div>
                    <div class="card elevation-2">
                        <h3 class="card-title">
                            <span class="card-icon material-icons">alarm</span>
                            Upcoming Deadlines
                        </h3>
                        <ul class="upcoming-list" id="upcoming-list">
                            <li class="upcoming-item">
                                <div class="upcoming-date">Nov 15</div>
                                <div class="upcoming-content">
                                    <div class="upcoming-title">No upcoming deadlines</div>
                                    <div class="upcoming-subject">Add tasks to track deadlines</div>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div class="card elevation-2">
                        <h3 class="card-title">
                            <span class="card-icon material-icons">target</span>
                            Weekly Goals
                        </h3>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <div class="stat-number" id="week-target">5</div>
                                <div class="stat-label">Target Topics</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="week-completed">0</div>
                                <div class="stat-label">Completed</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="tasks-pending">0</div>
                                <div class="stat-label">Tasks Pending</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="study-streak">0</div>
                                <div class="stat-label">Study Streak</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Tasks Page -->
            <div id="tasks" class="page">
                <div class="task-manager elevation-2">
                    <div class="task-header">
                        <h2><i class="material-icons">task</i> Task Manager</h2>
                        <button class="add-task-btn" onclick="toggleTaskForm()">
                            <i class="material-icons">add</i> Add Task
                        </button>
                    </div>
                    <div class="task-form" id="task-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Task Title</label>
                                <input type="text" class="form-input" id="task-title" placeholder="Enter task title">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Subject</label>
                                <select class="form-select" id="task-subject">
                                    <option value="math">Mathematics</option>
                                    <option value="english">English</option>
                                    <option value="general">General</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Priority</label>
                                <select class="form-select" id="task-priority">
                                    <option value="low">Low</option>
                                    <option value="medium">Medium</option>
                                    <option value="high">High</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Due Date</label>
                                <input type="date" class="form-input" id="task-due-date">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Type</label>
                                <select class="form-select" id="task-type">
                                    <option value="assignment">Assignment</option>
                                    <option value="revision">Revision</option>
                                    <option value="past-paper">Past Paper</option>
                                    <option value="reading">Reading</option>
                                    <option value="practice">Practice</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Estimated Time (mins)</label>
                                <input type="number" class="form-input" id="task-time" placeholder="30">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Description</label>
                            <textarea class="form-textarea" id="task-description" placeholder="Task details..."></textarea>
                        </div>
                        <div class="form-actions">
                            <button class="btn btn-secondary" onclick="toggleTaskForm()">
                                <i class="material-icons">cancel</i> Cancel
                            </button>
                            <button class="btn btn-primary" onclick="addTask()">
                                <i class="material-icons">check</i> Add Task
                            </button>
                        </div>
                    </div>
                    <div class="task-list" id="task-list">
                        <!-- Tasks will be dynamically added here -->
                    </div>
                </div>
            </div>
            <!-- Analytics Page -->
            <div id="analytics" class="page">
                <div class="analytics-grid">
                    <div class="chart-container elevation-2">
                        <h3 class="chart-title">📊 Subject Progress Comparison</h3>
                        <div id="progress-chart" style="height: 300px; display: flex; align-items: center; justify-content: center; color: var(--text-secondary);">
                            <div style="text-align: center; padding: 20px;">
                                <i class="material-icons" style="font-size: 48px; opacity: 0.3;">bar_chart</i>
                                <p>Subject Progress Visualization</p>
                            </div>
                        </div>
                    </div>
                    <div class="chart-container elevation-2">
                        <h3 class="chart-title">📈 Weekly Study Progress</h3>
                        <div id="weekly-chart" style="height: 300px; display: flex; align-items: center; justify-content: center; color: var(--text-secondary);">
                            <div style="text-align: center; padding: 20px;">
                                <i class="material-icons" style="font-size: 48px; opacity: 0.3;">trending_up</i>
                                <p>Weekly Study Trends</p>
                            </div>
                        </div>
                    </div>
                    <div class="chart-container elevation-2">
                        <h3 class="chart-title">🎯 Topic Status Distribution</h3>
                        <div id="status-chart" style="height: 300px; display: flex; align-items: center; justify-content: center; color: var(--text-secondary);">
                            <div style="text-align: center; padding: 20px;">
                                <i class="material-icons" style="font-size: 48px; opacity: 0.3;">pie_chart</i>
                                <p>Topic Status Overview</p>
                            </div>
                        </div>
                    </div>
                    <div class="chart-container elevation-2">
                        <h3 class="chart-title">⏱️ Study Time Analysis</h3>
                        <div id="time-chart" style="height: 300px; display: flex; align-items: center; justify-content: center; color: var(--text-secondary);">
                            <div style="text-align: center; padding: 20px;">
                                <i class="material-icons" style="font-size: 48px; opacity: 0.3;">access_time</i>
                                <p>Study Time Patterns</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Notes Page -->
            <div id="notes" class="page">
                <div class="notes-container elevation-2">
                    <div class="notes-header">
                        <h2><i class="material-icons">note</i> Study Notes</h2>
                        <button class="add-task-btn" onclick="toggleNoteEditor()">
                            <i class="material-icons">add</i> Add Note
                        </button>
                    </div>
                    <div class="note-editor" id="note-editor">
                        <div class="form-group">
                            <label class="form-label">Note Title</label>
                            <input type="text" class="form-input" id="note-title" placeholder="Enter note title">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Subject</label>
                                <select class="form-select" id="note-subject">
                                    <option value="math">Mathematics</option>
                                    <option value="english">English</option>
                                    <option value="general">General</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Topic</label>
                                <input type="text" class="form-input" id="note-topic" placeholder="Related topic">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Content</label>
                            <textarea class="form-textarea" id="note-content" placeholder="Write your notes here..." style="min-height: 120px;"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Resources/Links</label>
                            <input type="text" class="form-input" id="note-resources" placeholder="URLs, references, etc.">
                        </div>
                        <div class="form-actions">
                            <button class="btn btn-secondary" onclick="toggleNoteEditor()">
                                <i class="material-icons">cancel</i> Cancel
                            </button>
                            <button class="btn btn-primary" onclick="saveNote()">
                                <i class="material-icons">save</i> Save Note
                            </button>
                        </div>
                    </div>
                    <div class="notes-list" id="notes-list">
                        <!-- Notes will be dynamically added here -->
                    </div>
                </div>
            </div>
            <!-- Subject Pages -->
            <div id="math-september" class="page">
                <div class="topic-list" id="math-september-content">
                    <div class="topic-header">
                        <h2><i class="material-icons">calculate</i> Mathematics - September 2025</h2>
                    </div>
                </div>
            </div>
            <div id="math-october" class="page">
                <div class="topic-list" id="math-october-content">
                    <div class="topic-header">
                        <h2><i class="material-icons">calculate</i> Mathematics - October 2025</h2>
                    </div>
                </div>
            </div>
            <div id="math-november" class="page">
                <div class="topic-list" id="math-november-content">
                    <div class="topic-header">
                        <h2><i class="material-icons">calculate</i> Mathematics - November 2025</h2>
                    </div>
                </div>
            </div>
            <div id="math-december" class="page">
                <div class="topic-list" id="math-december-content">
                    <div class="topic-header">
                        <h2><i class="material-icons">calculate</i> Mathematics - December 2025</h2>
                    </div>
                </div>
            </div>
            <div id="english-september" class="page">
                <div class="topic-list" id="english-september-content">
                    <div class="topic-header">
                        <h2><i class="material-icons">book</i> English - September 2025</h2>
                    </div>
                </div>
            </div>
            <div id="english-october" class="page">
                <div class="topic-list" id="english-october-content">
                    <div class="topic-header">
                        <h2><i class="material-icons">book</i> English - October 2025</h2>
                    </div>
                </div>
            </div>
            <div id="english-november" class="page">
                <div class="topic-list" id="english-november-content">
                    <div class="topic-header">
                        <h2><i class="material-icons">book</i> English - November 2025</h2>
                    </div>
                </div>
            </div>
            <div id="english-december" class="page">
                <div class="topic-list" id="english-december-content">
                    <div class="topic-header">
                        <h2><i class="material-icons">book</i> English - December 2025</h2>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <!-- Modal for Notes -->
    <div class="modal" id="note-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modal-note-title">Note Title</h3>
                <button class="close-btn" onclick="closeNoteModal()">
                    <i class="material-icons">close</i>
                </button>
            </div>
            <div id="modal-note-content">
                <!-- Note content will be displayed here -->
            </div>
        </div>
    </div>
    <div id="celebration" class="celebration"></div>
    <script>
        // Data structures
        const mathCurriculum = {
            "September 2025": {
                "Number": [
                    "Types of numbers: primes, squares, cubes, rational/irrational",
                    "Powers and roots",
                    "Standard form (scientific notation)",
                    "Fractions, decimals, percentages",
                    "Ratio, proportion, exchange rates",
                    "Percentages: increase/decrease, reverse %, compound interest",
                    "Surds: simplify and manipulate"
                ],
                "Algebra": [
                    "Substitution into formulae",
                    "Simplifying expressions",
                    "Expanding brackets",
                    "Factorising (common factors, quadratics)"
                ]
            },
            "October 2025": {
                "Algebra": [
                    "Algebraic fractions: simplifying, adding, multiplying",
                    "Indices II: fractional and negative powers",
                    "Solving linear equations",
                    "Solving quadratic equations (factorising, formula, completing the square)",
                    "Simultaneous equations (linear and one non-linear)",
                    "Inequalities: solve and represent on number line",
                    "Sequences: nth term for linear, quadratic, cubic, exponential",
                    "Direct and inverse proportion (including squares, cubes, roots)"
                ],
                "Coordinate Geometry": [
                    "Plotting points",
                    "Gradient of a line",
                    "Midpoint and length of a segment",
                    "Equation of a straight line: y = mx + c",
                    "Parallel and perpendicular lines"
                ]
            },
            "November 2025": {
                "Geometry": [
                    "Geometric terms and angle properties (parallel lines, polygons)",
                    "Scale drawings and three-figure bearings",
                    "Similarity: scale factors for length, area, volume",
                    "Symmetry: line and rotational (2D and 3D)",
                    "Circle theorems: angles in semicircle, at centre, same segment",
                    "Circle theorems: cyclic quadrilaterals, alternate segment"
                ],
                "Mensuration": [
                    "Units and conversions (length, area, volume)",
                    "Perimeter and area: rectangles, triangles, circles, sectors",
                    "Surface area and volume: prisms, cylinders, spheres",
                    "Surface area and volume: cones, pyramids",
                    "Compound shapes and frustums"
                ],
                "Trigonometry": [
                    "Pythagoras' Theorem (2D and 3D)",
                    "Trigonometry in right-angled triangles (SOH CAH TOA)",
                    "Angles of elevation and depression"
                ]
            },
            "December 2025": {
                "Advanced Trigonometry": [
                    "Exact values: sin, cos, tan at 0°, 30°, 45°, 60°, 90°",
                    "Trigonometric graphs: sketching and solving equations",
                    "Sine Rule, Cosine Rule, Area = ½ab sin C",
                    "3D problems using trig and Pythagoras"
                ],
                "Graphs & Functions": [
                    "Travel graphs, speed-time graphs (area = distance)",
                    "Sketching: linear, quadratic, cubic, reciprocal, exponential",
                    "Differentiation: estimating gradients, finding stationary points",
                    "Functions: notation, inverse, composite"
                ],
                "Vectors": [
                    "Vector notation and arithmetic (add, subtract, scalar multiply)",
                    "Magnitude of a vector",
                    "Using vectors in geometric proofs"
                ],
                "Statistics": [
                    "Data collection and representation: tables, bar charts, pie charts, stem-and-leaf",
                    "Averages: mean, median, mode; spread: range, IQR",
                    "Scatter diagrams: correlation, line of best fit",
                    "Cumulative frequency: median, quartiles, IQR",
                    "Histograms: frequency density"
                ]
            }
        };
        const englishCurriculum = {
            "September 2025": {
                "Reading Skills": [
                    "Comprehension: explicit and implicit meanings",
                    "Analysis: writer's use of language (imagery, tone, word choice)",
                    "Analysis: writer's use of structure (paragraphing, focus shifts, narrative viewpoint)",
                    "Analysis: writer's use of form (genre, purpose, audience)",
                    "Summary: select and condense key information from two passages",
                    "Practice texts: travel writing, journalism, essays, reports"
                ],
                "Writing Skills": [
                    "Accuracy: spelling, punctuation, grammar",
                    "Vocabulary: precise and varied word choice",
                    "Register & style: formal vs informal, objective vs subjective"
                ]
            },
            "October 2025": {
                "Directed Writing": [
                    "Read passage and write a new piece (article, report, letter)",
                    "Change purpose, audience, or form",
                    "Appropriate tone, structure, and content",
                    "Clarity, organisation, accuracy"
                ],
                "Argument Writing": [
                    "Discursive/Evaluative: discuss topic from multiple viewpoints",
                    "Persuasive: argue a case with evidence and rhetorical devices",
                    "Plan essays: clear introduction, development, conclusion"
                ]
            },
            "November 2025": {
                "Reading Fiction": [
                    "Narrative extracts: short stories, novels",
                    "Analyse: Characterisation and setting",
                    "Analyse: Plot development and narrative voice",
                    "Analyse: Use of language and structure to create mood and tension",
                    "Compare two passages"
                ],
                "Creative Writing": [
                    "Narrative writing: plot, character, setting",
                    "Descriptive writing: vivid imagery using sensory details",
                    "Techniques: show vs tell, dialogue, pacing, figurative language",
                    "Practice prompts: 'Write about a moment of discovery'"
                ]
            },
            "December 2025": {
                "Coursework Portfolio": [
                    "Assignment 1: Directed Writing + Reading",
                    "Assignment 2: Creative Writing",
                    "Focus: originality, impact, technical accuracy"
                ],
                "Speaking and Listening Test": [
                    "Individual talk (3–5 mins) - Topic of personal interest",
                    "Cue card: bullet points, structure: introduction, main points, conclusion",
                    "Conversation (3–5 mins) - Discussion with examiner",
                    "Practice active listening, natural dialogue"
                ],
                "Revision & Practice": [
                    "Review all writing samples",
                    "Practice timed exam responses for Papers 3 and 4"
                ]
            }
        };

        // Global state - Using localStorage for persistence
        let studyData = JSON.parse(localStorage.getItem('studyData')) || {
            progress: { math: {}, english: {} },
            tasks: [],
            notes: [],
            settings: {
                weeklyTarget: 5,
                studyStreak: 0
            }
        };

        // Initialize application
        function initializeApp() {
            generateAllContent();
            updateDashboard();
            updateAnalytics();
            // Set default due date to today
            const today = new Date().toISOString().split('T')[0];
            const dueDateInput = document.getElementById('task-due-date');
            if (dueDateInput) {
                dueDateInput.value = today;
            }
            // Load saved data
            renderTasks();
            renderNotes();
        }

        // Navigation functions
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));
            // Show selected page
            const selectedPage = document.getElementById(pageId);
            if (selectedPage) {
                selectedPage.classList.add('active');
            }
            // Update nav - find the clicked nav link
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                if (link.onclick && link.onclick.toString().includes(`'${pageId}'`)) {
                    link.classList.add('active');
                }
            });
            // Update header
            const titles = {
                'dashboard': 'Dashboard Overview',
                'tasks': 'Task Manager',
                'analytics': 'Progress Analytics',
                'notes': 'Study Notes'
            };
            const pageTitle = document.getElementById('page-title');
            if (pageTitle) {
                pageTitle.textContent = titles[pageId] || pageId;
            }
        }

        function showSubjectPage(subject, month) {
            const pageId = `${subject}-${month}`;
            showPage(pageId);
            const pageTitle = document.getElementById('page-title');
            if (pageTitle) {
                pageTitle.textContent = `${subject.charAt(0).toUpperCase() + subject.slice(1)} - ${month.charAt(0).toUpperCase() + month.slice(1)} 2025`;
            }
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            if (sidebar) {
                sidebar.classList.toggle('collapsed');
            }
        }

        function toggleMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            if (sidebar) {
                sidebar.classList.toggle('mobile-open');
            }
        }

        function toggleSubject(subject) {
            const monthsElement = document.getElementById(`${subject}-months`);
            if (monthsElement) {
                monthsElement.classList.toggle('expanded');
            }
        }

        // Content generation
        function generateAllContent() {
            generateSubjectContent('math', mathCurriculum);
            generateSubjectContent('english', englishCurriculum);
        }

        function generateSubjectContent(subject, curriculum) {
            Object.keys(curriculum).forEach(month => {
                const monthKey = month.split(' ')[0].toLowerCase();
                const containerId = `${subject}-${monthKey}-content`;
                const container = document.getElementById(containerId);
                if (!container) return;
                // Clear existing content except header
                const existingContent = container.querySelectorAll('.month-section');
                existingContent.forEach(section => section.remove());
                Object.keys(curriculum[month]).forEach(group => {
                    const monthSection = document.createElement('div');
                    monthSection.className = 'month-section';
                    const monthHeader = document.createElement('div');
                    monthHeader.className = 'month-header';
                    monthHeader.onclick = () => toggleMonthSection(monthSection);
                    const monthTitle = document.createElement('h3');
                    monthTitle.className = 'month-title';
                    monthTitle.textContent = group;
                    const progressSpan = document.createElement('span');
                    progressSpan.className = 'month-progress';
                    progressSpan.textContent = '0/0 completed';
                    const expandIcon = document.createElement('span');
                    expandIcon.className = 'expand-icon material-icons';
                    expandIcon.textContent = 'expand_more';
                    monthHeader.appendChild(monthTitle);
                    monthHeader.appendChild(progressSpan);
                    monthHeader.appendChild(expandIcon);
                    const monthContent = document.createElement('div');
                    monthContent.className = 'month-content expanded';
                    const topicGroup = document.createElement('div');
                    topicGroup.className = 'topic-group';
                    curriculum[month][group].forEach(topic => {
                        const topicItem = document.createElement('div');
                        topicItem.className = 'topic-item';
                        const statusIndicator = document.createElement('div');
                        statusIndicator.className = 'status-indicator status-not-started';
                        statusIndicator.onclick = (e) => {
                            e.stopPropagation();
                            cycleTopicStatus(subject, month, group, topic, statusIndicator);
                        };
                        const topicText = document.createElement('div');
                        topicText.className = 'topic-text';
                        topicText.textContent = topic;
                        const topicActions = document.createElement('div');
                        topicActions.className = 'topic-actions';
                        const noteBtn = document.createElement('button');
                        noteBtn.className = 'action-btn note-btn';
                        noteBtn.innerHTML = '<i class="material-icons">note</i>';
                        noteBtn.title = 'Add note';
                        noteBtn.onclick = (e) => {
                            e.stopPropagation();
                            openNoteEditor(subject, topic);
                        };
                        topicActions.appendChild(noteBtn);
                        topicItem.appendChild(statusIndicator);
                        topicItem.appendChild(topicText);
                        topicItem.appendChild(topicActions);
                        topicGroup.appendChild(topicItem);
                    });
                    monthContent.appendChild(topicGroup);
                    monthSection.appendChild(monthHeader);
                    monthSection.appendChild(monthContent);
                    container.appendChild(monthSection);
                });
            });
        }

        function toggleMonthSection(section) {
            const header = section.querySelector('.month-header');
            const content = section.querySelector('.month-content');
            if (header && content) {
                header.classList.toggle('expanded');
                content.classList.toggle('expanded');
            }
        }

        function cycleTopicStatus(subject, month, group, topic, indicator) {
            const topicKey = `${subject}-${month}-${group}-${topic}`;
            if (!studyData.progress[subject]) {
                studyData.progress[subject] = {};
            }
            const currentStatus = studyData.progress[subject][topicKey] || 'not-started';
            let newStatus;
            switch (currentStatus) {
                case 'not-started':
                    newStatus = 'in-progress';
                    break;
                case 'in-progress':
                    newStatus = 'mastered';
                    break;
                case 'mastered':
                    newStatus = 'not-started';
                    break;
                default:
                    newStatus = 'in-progress';
            }
            studyData.progress[subject][topicKey] = newStatus;
            // Update visual indicator
            indicator.className = `status-indicator status-${newStatus}`;
            // Show celebration for mastered topics
            if (newStatus === 'mastered') {
                showCelebration('Topic Mastered! 🎉');
            }
            updateDashboard();
            saveToLocalStorage();
        }

        function showCelebration(message) {
            const celebration = document.getElementById('celebration');
            if (celebration) {
                celebration.textContent = message;
                celebration.style.display = 'block';
                setTimeout(() => {
                    celebration.style.display = 'none';
                }, 2000);
            }
        }

        // Task management
        function toggleTaskForm() {
            const taskForm = document.getElementById('task-form');
            if (taskForm) {
                taskForm.classList.toggle('active');
            }
        }

        function addTask() {
            const title = document.getElementById('task-title')?.value;
            const subject = document.getElementById('task-subject')?.value;
            const priority = document.getElementById('task-priority')?.value;
            const dueDate = document.getElementById('task-due-date')?.value;
            const type = document.getElementById('task-type')?.value;
            const time = document.getElementById('task-time')?.value;
            const description = document.getElementById('task-description')?.value;
            if (!title || !dueDate) {
                alert('Please fill in the task title and due date.');
                return;
            }
            const task = {
                id: Date.now(),
                title,
                subject,
                priority,
                dueDate,
                type,
                estimatedTime: parseInt(time) || 30,
                description,
                completed: false,
                createdAt: new Date().toISOString()
            };
            studyData.tasks.push(task);
            renderTasks();
            toggleTaskForm();
            clearTaskForm();
            updateDashboard();
            saveToLocalStorage();
        }

        function clearTaskForm() {
            const inputs = ['task-title', 'task-description', 'task-time'];
            inputs.forEach(id => {
                const element = document.getElementById(id);
                if (element) element.value = '';
            });
            const dateInput = document.getElementById('task-due-date');
            if (dateInput) dateInput.value = new Date().toISOString().split('T')[0];
        }

        function renderTasks() {
            const taskList = document.getElementById('task-list');
            if (!taskList) return;
            taskList.innerHTML = '';
            if (studyData.tasks.length === 0) {
                taskList.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">No tasks yet. Add one to get started!</p>';
                return;
            }
            studyData.tasks.forEach(task => {
                const taskItem = document.createElement('div');
                taskItem.className = 'task-item';
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.className = 'task-checkbox';
                checkbox.checked = task.completed;
                checkbox.onchange = () => toggleTask(task.id);
                const taskContent = document.createElement('div');
                taskContent.className = 'task-content';
                const taskTitle = document.createElement('div');
                taskTitle.className = 'task-title';
                taskTitle.textContent = task.title;
                if (task.completed) {
                    taskTitle.style.textDecoration = 'line-through';
                    taskTitle.style.opacity = '0.6';
                }
                const taskMeta = document.createElement('div');
                taskMeta.className = 'task-meta';
                const priorityBadge = document.createElement('span');
                priorityBadge.className = `priority-badge priority-${task.priority}`;
                priorityBadge.textContent = task.priority.toUpperCase();
                taskMeta.innerHTML = `
                    <span>${task.subject}</span>
                    <span>${task.type}</span>
                    <span>Due: ${new Date(task.dueDate).toLocaleDateString()}</span>
                    <span>${task.estimatedTime} mins</span>
                `;
                taskMeta.appendChild(priorityBadge);
                taskContent.appendChild(taskTitle);
                taskContent.appendChild(taskMeta);
                taskItem.appendChild(checkbox);
                taskItem.appendChild(taskContent);
                taskList.appendChild(taskItem);
            });
        }

        function toggleTask(taskId) {
            const task = studyData.tasks.find(t => t.id === taskId);
            if (task) {
                task.completed = !task.completed;
                if (task.completed) {
                    showCelebration('Task Completed! ✅');
                }
                renderTasks();
                updateDashboard();
                saveToLocalStorage();
            }
        }

        // Note management
        function toggleNoteEditor() {
            const noteEditor = document.getElementById('note-editor');
            if (noteEditor) {
                noteEditor.classList.toggle('active');
            }
        }

        function openNoteEditor(subject, topic) {
            toggleNoteEditor();
            const subjectSelect = document.getElementById('note-subject');
            const topicInput = document.getElementById('note-topic');
            if (subjectSelect) subjectSelect.value = subject;
            if (topicInput) topicInput.value = topic;
        }

        function saveNote() {
            const title = document.getElementById('note-title')?.value;
            const subject = document.getElementById('note-subject')?.value;
            const topic = document.getElementById('note-topic')?.value;
            const content = document.getElementById('note-content')?.value;
            const resources = document.getElementById('note-resources')?.value;
            if (!title || !content) {
                alert('Please fill in the note title and content.');
                return;
            }
            const note = {
                id: Date.now(),
                title,
                subject,
                topic,
                content,
                resources,
                createdAt: new Date().toISOString()
            };
            studyData.notes.push(note);
            renderNotes();
            toggleNoteEditor();
            clearNoteForm();
            saveToLocalStorage();
        }

        function clearNoteForm() {
            const inputs = ['note-title', 'note-topic', 'note-content', 'note-resources'];
            inputs.forEach(id => {
                const element = document.getElementById(id);
                if (element) element.value = '';
            });
        }

        function renderNotes() {
            const notesList = document.getElementById('notes-list');
            if (!notesList) return;
            notesList.innerHTML = '';
            if (studyData.notes.length === 0) {
                notesList.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">No notes yet. Add one to get started!</p>';
                return;
            }
            studyData.notes.forEach(note => {
                const noteItem = document.createElement('div');
                noteItem.className = 'note-item';
                noteItem.onclick = () => openNoteModal(note);
                const noteTitle = document.createElement('div');
                noteTitle.className = 'note-title';
                noteTitle.textContent = note.title;
                const notePreview = document.createElement('div');
                notePreview.className = 'note-preview';
                notePreview.textContent = note.content.substring(0, 100) + (note.content.length > 100 ? '...' : '');
                const noteMeta = document.createElement('div');
                noteMeta.style.cssText = 'font-size: 0.85rem; color: var(--text-secondary); margin-top: 8px;';
                noteMeta.textContent = `${note.subject} • ${note.topic || 'General'} • ${new Date(note.createdAt).toLocaleDateString()}`;
                const noteActions = document.createElement('div');
                noteActions.className = 'note-actions';
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'action-btn delete-btn';
                deleteBtn.innerHTML = '<i class="material-icons">delete</i>';
                deleteBtn.title = 'Delete note';
                deleteBtn.onclick = (e) => {
                    e.stopPropagation();
                    deleteNote(note.id);
                };
                noteActions.appendChild(deleteBtn);
                noteItem.appendChild(noteTitle);
                noteItem.appendChild(notePreview);
                noteItem.appendChild(noteMeta);
                noteItem.appendChild(noteActions);
                notesList.appendChild(noteItem);
            });
        }

        function deleteNote(noteId) {
            if (confirm('Are you sure you want to delete this note?')) {
                studyData.notes = studyData.notes.filter(note => note.id !== noteId);
                renderNotes();
                saveToLocalStorage();
            }
        }

        function openNoteModal(note) {
            const modal = document.getElementById('note-modal');
            const modalTitle = document.getElementById('modal-note-title');
            const modalContent = document.getElementById('modal-note-content');
            if (modal && modalTitle && modalContent) {
                modalTitle.textContent = note.title;
                modalContent.innerHTML = `
                    <div style="margin-bottom: 15px; color: var(--text-secondary); font-size: 0.9rem;">
                        <strong>Subject:</strong> ${note.subject} | <strong>Topic:</strong> ${note.topic || 'General'} | 
                        <strong>Created:</strong> ${new Date(note.createdAt).toLocaleDateString()}
                    </div>
                    <div style="white-space: pre-wrap; line-height: 1.6; margin-bottom: 15px;">${note.content}</div>
                    ${note.resources ? `<div style="color: var(--primary);"><strong>Resources:</strong><br>${note.resources}</div>` : ''}
                `;
                modal.classList.add('active');
            }
        }

        function closeNoteModal() {
            const modal = document.getElementById('note-modal');
            if (modal) {
                modal.classList.remove('active');
            }
        }

        // Dashboard updates
        function updateDashboard() {
            updateProgressStats('math');
            updateProgressStats('english');
            updateUpcomingTasks();
            updateWeeklyGoals();
        }

        function updateProgressStats(subject) {
            const progress = studyData.progress[subject] || {};
            const topics = Object.keys(progress);
            const mastered = topics.filter(key => progress[key] === 'mastered').length;
            const inProgress = topics.filter(key => progress[key] === 'in-progress').length;
            const notStarted = topics.filter(key => progress[key] === 'not-started').length;
            // Count total topics from curriculum
            const curriculum = subject === 'math' ? mathCurriculum : englishCurriculum;
            let totalTopics = 0;
            Object.keys(curriculum).forEach(month => {
                Object.keys(curriculum[month]).forEach(group => {
                    totalTopics += curriculum[month][group].length;
                });
            });
            const progressPercentage = totalTopics > 0 ? Math.round((mastered / totalTopics) * 100) : 0;
            // Update DOM elements
            const elements = {
                [`${subject}-mastered`]: mastered,
                [`${subject}-progress`]: inProgress,
                [`${subject}-not-started`]: totalTopics - mastered - inProgress,
                [`${subject}-total`]: totalTopics,
                [`${subject}-progress-text`]: `${progressPercentage}%`
            };
            Object.keys(elements).forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = elements[id];
                }
            });
            // Update progress ring
            const ring = document.getElementById(`${subject}-ring`);
            if (ring) {
                const circumference = 2 * Math.PI * 40; // radius is 40
                const offset = circumference - (progressPercentage / 100) * circumference;
                ring.style.strokeDashoffset = offset;
            }
        }

        function updateUpcomingTasks() {
            const upcomingList = document.getElementById('upcoming-list');
            if (!upcomingList) return;
            const incompleteTasks = studyData.tasks.filter(task => !task.completed);
            const sortedTasks = incompleteTasks.sort((a, b) => new Date(a.dueDate) - new Date(b.dueDate));
            upcomingList.innerHTML = '';
            if (sortedTasks.length === 0) {
                upcomingList.innerHTML = `
                    <li class="upcoming-item">
                        <div class="upcoming-date">--</div>
                        <div class="upcoming-content">
                            <div class="upcoming-title">No upcoming deadlines</div>
                            <div class="upcoming-subject">Add tasks to track deadlines</div>
                        </div>
                    </li>
                `;
                return;
            }
            sortedTasks.slice(0, 3).forEach(task => {
                const item = document.createElement('li');
                item.className = 'upcoming-item';
                const date = new Date(task.dueDate);
                const dateStr = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                item.innerHTML = `
                    <div class="upcoming-date">${dateStr}</div>
                    <div class="upcoming-content">
                        <div class="upcoming-title">${task.title}</div>
                        <div class="upcoming-subject">${task.subject} • ${task.priority} priority</div>
                    </div>
                `;
                upcomingList.appendChild(item);
            });
        }

        function updateWeeklyGoals() {
            const completedTasks = studyData.tasks.filter(task => task.completed).length;
            const pendingTasks = studyData.tasks.filter(task => !task.completed).length;
            // Count topics mastered this week (simplified - count all mastered)
            const mathMastered = Object.values(studyData.progress.math || {}).filter(status => status === 'mastered').length;
            const englishMastered = Object.values(studyData.progress.english || {}).filter(status => status === 'mastered').length;
            const totalMastered = mathMastered + englishMastered;
            const elements = {
                'week-completed': totalMastered,
                'tasks-pending': pendingTasks,
                'study-streak': studyData.settings.studyStreak
            };
            Object.keys(elements).forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = elements[id];
                }
            });
        }

        function updateAnalytics() {
            // Simple placeholder for analytics
            console.log('Analytics updated');
        }

        // Local Storage Functions
        function saveToLocalStorage() {
            localStorage.setItem('studyData', JSON.stringify(studyData));
        }

        // Initialize the application when the page loads
        document.addEventListener('DOMContentLoaded', initializeApp);

        // Close modal when clicking outside
        document.addEventListener('click', (e) => {
            const modal = document.getElementById('note-modal');
            if (modal && e.target === modal) {
                closeNoteModal();
            }
        });

        // Close mobile menu when clicking outside
        document.addEventListener('click', (e) => {
            const sidebar = document.getElementById('sidebar');
            const toggleBtn = document.querySelector('.mobile-menu-toggle');
            if (sidebar && sidebar.classList.contains('mobile-open') && 
                !sidebar.contains(e.target) && e.target !== toggleBtn) {
                sidebar.classList.remove('mobile-open');
            }
        });

        // Auto-save every 30 seconds
        setInterval(() => {
            saveToLocalStorage();
        }, 30000);
    </script>
</body>
</html>
